name: BuildandDeploy
on:
  push:
    branches:
      - main

jobs:
  build:
    name:Build
    runs-on:ubuntu-latest
    steps:
      -name:CheckoutRepo
        uses:actions/checkout@main
      -name:InstallDependencies
        run:npminstall
      -name:Build
        run:npmrunbuild
        env: 
          PAYPAL_CLIENT_ID:${{secrets.PAYPAL_CLIENT_ID}}
          GOOGLE_API_KEY:${{secrets.GOOGLE_API_KEY}}
      -name:ArchiveProductionArtifact
        uses:actions/upload-artifact@master
        with:
          name:dist
          path:dist
  deploy:
    name:Deploy
    needs:build
    runs-on:ubuntu-latest
    steps:
      -name:CheckoutRepo
        uses:actions/checkout@main
      -name:DownloadArtifact
        uses:actions/download-artifact@master
        with:
          name:dist
          path:dist
      -name:DeploytoFirebase
        uses:w9jds/firebase-action@master
        with:
          args:deploy--onlyhosting
        env:
          FIREBASE_TOKEN:${{secrets.FIREBASE_TOKEN}}